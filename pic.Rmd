
library(shiny)

ui <- fluidPage(
  titlePanel("Picross Game"),
  mainPanel(
    tableOutput("picrossGrid"),
    actionButton("checkButton", "Check Solution")
  )
)

server <- function(input, output, session) {
  # Taille du picross
  rows <- 5
  cols <- 5

  # Génération d'une solution aléatoire
  solution <- matrix(sample(c(0, 1), rows * cols, replace = TRUE), nrow = rows, ncol = cols)

  # Tableau pour stocker l'état actuel du joueur
  playerGrid <- reactiveVal(matrix(0, nrow = rows, ncol = cols))

  # Affichage du picross
  output$picrossGrid <- renderTable({
    playerGrid()
  }, bordered = TRUE)

  # Mise à jour du tableau du joueur lorsqu'une case est cliquée
  observeEvent(input$picrossGrid_cell_clicked, {
    info <- input$picrossGrid_cell_clicked
    i <- info$row
    j <- info$col

    currentGrid <- playerGrid()
    currentGrid[i, j] <- 1 - currentGrid[i, j]  # Inversion 0/1
    playerGrid(currentGrid)
  })

  # Vérification de la solution lorsque le bouton est cliqué
  observeEvent(input$checkButton, {
    if (identical(playerGrid(), solution)) {
      showModal(
        modalDialog(
          title = "Félicitations!",
          "Vous avez résolu le Picross avec succès.",
          easyClose = TRUE
        )
      )
    } else {
      showModal(
        modalDialog(
          title = "Échec",
          "La solution n'est pas correcte. Réessayez!",
          easyClose = TRUE
        )
      )
    }
  })
}

shinyApp(ui, server)
